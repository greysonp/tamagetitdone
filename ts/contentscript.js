console.log(createjs);
console.log($);
this.tgd=this.tgd||{};
(function(){var tid={};var started=false;var t={};var domain="";var timer={};timer.init=function(){tid=setInterval(function(){myTimer();},1000);started=1;t=0;domain=window.location.host;};function myTimer(){t=t+1;}timer.restartTimer=function(){if(!started){tid=setInterval(function(){myTimer();},1000);started=1;}};timer.pauseTimer=function(){clearInterval(tid);started=0;};timer.saveTime=function(){localStorage.setItem(domain,t);tgd.log(domain+" : "+t);};timer.getTime=function(){tgd.log(domain+" : "+localStorage.getItem(domain));};this.tgd.timer=timer;var tid={};var t={};var domain="";var started=false;var isActive=true;var timer={};var cb={};timer.init=function(callback){cb=callback;tid=setInterval(function(){myTimer();if(isActive){cb();}},1000);started=1;t=0;domain=window.location.host;};function myTimer(){if(isActive){t=t+1;}}timer.restartTimer=function(callback){if(!started){cb=callback;tid=setInterval(function(){myTimer();cb();},1000);started=1;}};timer.pauseTimer=function(){clearInterval(tid);started=0;};timer.saveTime=function(){localStorage.setItem(domain,t);tgd.log("SAVED: "+domain+" : "+t);};timer.getTime=function(){var curTime=localStorage.getItem(domain);tgd.log("RETRIEVED: "+domain+" : "+curTime);return curTime;};window.onfocus=function(){isActive=true;};window.onblur=function(){isActive=false;};this.tgd.timer=timer;})();this.tgd=this.tgd||{};(function(){var anim={};var spritesheet={};var sprite={};anim.init=function(callback){spritesheet=new createjs.SpriteSheet({"animations":{"idle":{"frames":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"eat":{"frames":[2,2,5,5,6,6]},"run":{"frames":[2,2,2,3,3,3,4,4,4]},"eat_h":{"frames":[7,7,8,8,9,9,9]},"all":{"frames":[0]}},"images":["img/placeholder_anim.png"],"frames":[[0,0,256,256,0,-3,-19],[256,0,256,256,0,-3,-19],[512,0,256,256,0,-3,-19],[768,0,256,256,0,-3,-19],[1024,0,256,256,0,-3,-19],[1280,0,256,256,0,-3,-19],[1536,0,256,256,0,-3,-19],[1792,0,256,256,0,-3,-19],[0,256,256,256,0,-3,-19],[256,256,256,256,0,-3,-19]]});if(!spritesheet.complete){spritesheet.addEventListener("complete",function(){finishInit(callback);});}else{finishInit(callback);}};function finishInit(callback){sprite=new createjs.BitmapAnimation(spritesheet);anim.idle();tgd.stage.addChild(sprite);if(callback!=null){callback();}}anim.idle=function(flipped){sprite.gotoAndPlay("idle");};anim.run=function(flipped){sprite.gotoAndPlay("run");};anim.eat=function(flipped){if(flipped){sprite.gotoAndPlay("eat_h");}else{sprite.gotoAndPlay("eat");}};this.tgd.anim=anim;})();this.tgd=this.tgd||{};(function(){var action={};var $tgd={};var active=false;var mouseX=0;var mouseY=0;action.init=function(){$tgd=$("#tgd");$(document).mousemove(function(e){mouseX=e.pageX;mouseY=e.pageY;});$(document).scroll(function(){if(!active){$tgd.css("top",getTopOffset());}});$(window).resize(function(){if(!active){$tgd.css("top",getTopOffset());}});};action.idle=function(callback){tgd.anim.idle();active=true;setCanvasPosition();$tgd.stop().animate({top:getTopOffset(),left:0},500,"swing",function(){active=false;if(callback!=null){callback();}});};action.eat=function(callback){active=true;tgd.anim.run();var item=getClosestItem();tgd.log(item.get(0).tagName);if(item.get(0).tagName=="A"){item.click(function(e){e.preventDefault();});}var flipped=false;var x=item.offset().left-$tgd.width();if(x<0){x=item.offset().left+item.width();flipped=true;}var y=item.offset().top+item.height()/2-$tgd.height()/2-30;setCanvasPosition();$tgd.animate({left:x,top:y},500,"swing",function(){if(item.get(0).tagName=="A"){tgd.anim.eat(flipped);nom(item,callback);}else{item.css("display","none");active=false;if(callback!=null){callback();}}});};function nom(target,callback){var newText=target.text().substring(1);target.text(newText);$tgd.css("left",target.offset().left+target.width());if(newText.length>0){setTimeout(function(){nom(target,callback);},200);}else{target.css("display","none");active=false;if(callback!=null){callback();}}}function setCanvasPosition(){var x=$tgd.offset().left;var y=$tgd.offset().top;$tgd.css("left",x).css("top",y);}getTopOffset=function(){return $("#bottom-marker").offset().top-$tgd.height();};action.eatLinkStrong=function(){tgd.anim.run();};action.goToBed=function(){$("body").append('<img src="img/cord.png" id="cord" style="position: absolute; top:-200px; left: 65px;" />');$("#tgd").animate({bottom:getTopOffset()-20},750,"swing",function(){$("#cord").animate({top:-50},750,"swing",function(){setTimeout(function(){$("body").append('<div style="position:fixed; top:0px; left:0px; width:100%; height:100%; background-color:black; opacity:0.95; z-index:1000;"></div>');setTimeout(function(){$("body").append('<h1 id="bed-header" style="position:fixed; top: 30px; margin:auto; font-size:5em; color:white; font-family: sans-serif; opacity:0; z-index:2000">Go to bed.</h1>');$("#bed-header").animate({opacity:1},500);},500);},100);$("#cord").effect("bounce","slow");});$("#tgd").animate({top:200},750,"swing",function(){$("#tgd").animate({top:getTopOffset()},750);});});};function getClosestItem(){var minDist=9999999;var minIndex=9999999;$("a, img, iframe, embed").each(function(i){var x=$(this).offset().left+$(this).width()/2;var y=$(this).offset().top+$(this).height()/2;var dx=x-mouseX;var dy=y-mouseY;var dist=Math.sqrt((dx*dx)+(dy*dy));if(dist<minDist){minDist=dist;minIndex=i;}});return $("a, img, iframe, embed").eq(minIndex);}this.tgd.action=action;})();this.tgd=this.tgd||{};(function(){var main={};this.stage={};var FPS=30;this.useageTime=0;this.weakMax=300;this.strongMax=600;this.eatInterval=10;var hungerLevel=0;this.bedtimeHour=23;this.wakeupHour=8;var asleep=false;var sites=["reddit.com","youtube.com","facebook.com","twitter.com","techcrunch.com","stumbleupon.com","commitsfromlastnight.com","tumblr.com","memebase.com","pinterest.com"];main.init=function(){this.stage=new createjs.Stage("tgd");createjs.Ticker.addListener(main);createjs.Ticker.setFPS(FPS);createjs.Ticker.useRAF=true;main.anim.init(finishInit);};function finishInit(){main.action.init();if(checkBedtime()){return;}main.action.eat(function(){main.action.idle(function(){main.action.eat(function(){main.action.idle();});});});if(contains(sites,window.location.host)){main.timer.init(timerCallback);}else{main.log("Domain is not unproductive: "+window.location.host);}}function checkBedtime(){if(true){main.action.goToBed();return true;}}function timerCallback(){main.log("Timer Callback Received.");main.timer.saveTime();this.useageTime=main.timer.getTime();localStorage.setItem("hungerLevel",hungerLevel);checkHunger();checkSleep();}function checkHunger(){if(this.useageTime<this.weakMax){hungerLevel=0;main.log("Idle");}else{if(this.useageTime>=this.weakMax&&this.useageTime<this.strongMax){hungerLevel=1;main.log("Weak");}else{if(this.useageTime>=this.strongMax){hungerLevel=2;main.log("Strong");}}}}function checkSleep(){var curTime=new Date();var curHour=curTime.getHours();if((curHour>=bedtimeHour&&curHour<=24)||(curHour>=0&&curHour<wakeupHour)){if(!asleep){this.asleep=true;}}else{if(asleep){asleep=false;}}}main.isAsleep=function(){return asleep;};main.tick=function(){this.stage.update();};main.log=function(msg,isError){if(arguments.length==1||!isError){console.info(msg);}else{console.error(msg);}};function contains(a,obj){for(var i=0;i<a.length;i++){if(a[i]===obj){return true;}}return false;}this.tgd=main;})();
console.log(tgd);
tgd.init();